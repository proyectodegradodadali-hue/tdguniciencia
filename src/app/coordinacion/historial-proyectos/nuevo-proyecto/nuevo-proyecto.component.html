<!-- Fondo oscuro -->
<div *ngIf="mostrarModal()" (click)="cerrarModal()" class="fixed inset-0 z-40 bg-black opacity-25"></div>

<!-- Modal -->
<div *ngIf="mostrarModal()" class="overflow-x-hidden overflow-y-auto fixed inset-0 z-50 outline-none focus:outline-none justify-center items-center flex modal-fade-down">
    <div (click)="$event.stopPropagation()" class="relative mx-auto my-6 bg-white rounded-lg shadow-lg max-w-3xl w-full">
    <!-- Título del modal -->
    <div class="flex items-start justify-between p-5 border-b border-solid border-blueGray-200 rounded-t">
      <h3 class="text-xl font-semibold">
        Nuevo Proyecto
      </h3>
    </div>
    <form [formGroup]="agregarProyectoForm" (ngSubmit)="handleSave()">
    <!-- Contenido del modal -->
    <div class="relative p-6 flex-auto">

      <div class="flex flex-wrap mb-4">
        <div class="w-full lg:w-6/12 px-2">
            <div class="space-y-2">
              <label for="nombreProyecto" class="block text-sm font-medium text-gray-700">Nombre del proyecto *</label>
              <input type="text" id="nombreProyecto" formControlName="nombreProyecto" name="nombreProyecto" placeholder="Nombre del proyecto..." required
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
              <div class="text-red-600 text-xs mt-1" *ngIf="hasError('nombreProyecto')">
                {{ getErrorMessage('nombreProyecto') }}
              </div>
            </div>
        </div>
        <div class="w-full lg:w-6/12 px-2">
            <div class="space-y-2">
              <label for="codigoProyecto" class="block text-sm font-medium text-gray-700">Código del proyecto *</label>
              <input type="text" id="codigoProyecto" formControlName="codigoProyecto" name="codigoProyecto" placeholder="Código del proyecto..." required
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
              <div class="text-red-600 text-xs mt-1" *ngIf="hasError('codigoProyecto')">
                {{ getErrorMessage('codigoProyecto') }}
              </div>
            </div>
        </div>
      </div>
      <div class="flex flex-wrap mb-4">
          <div class="w-full lg:w-4/12 px-2">
            <div class="space-y-2">
              <label for="fechaInicio" class="block text-sm font-medium text-gray-700">Fecha de Inicio *</label>
              <input type="date" id="fechaInicio" formControlName="fechaInicio" name="fechaInicio" required
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
              <div class="text-red-600 text-xs mt-1" *ngIf="hasError('fechaInicio')">
                {{ getErrorMessage('fechaInicio') }}
              </div>
            </div>
          </div>
          <div class="w-full lg:w-4/12 px-2">
            <div class="space-y-2">
              <label for="fechaFin" class="block text-sm font-medium text-gray-700">Fecha de Fin *</label>
              <input type="date" id="fechaFin" formControlName="fechaFin" name="fechaFin" required
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
              <div class="text-red-600 text-xs mt-1" *ngIf="hasError('fechaFin')">
                {{ getErrorMessage('fechaFin') }}
              </div>
            </div>
          </div>
          <div class="w-full lg:w-4/12 px-2">
            <div class="space-y-2">
              <label for="programa" class="block text-sm font-medium text-gray-700">Programa *</label>
              <select id="programa" formControlName="programa" name="programa" required
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                <option [ngValue]="null" disabled>Seleccionar especialidad</option>
                <option value="Alta Costura">Alta Costura</option>
                <option value="Contaduría Pública">Contaduría Pública</option>
                <option value="Derecho">Derecho</option>
                <option value="Diseño de Modas">Diseño de Modas</option>
                <option value="Economía">Economía</option>
                <option value="Ingeniería Industrial">Ingeniería Industrial</option>
                <option value="Ingeniería de Sistemas">Ingeniería de Sistemas</option>
                <option value="Desarrollo de Software">Desarrollo de Software</option>
                <option value="Desarrollo Económico">Desarrollo Económico</option>
                <option value="Derecho Administrativo">Derecho Administrativo</option>
                <option value="Derecho Civil">Derecho Civil</option>
                <option value="Derecho Comercial">Derecho Comercial</option>
                <option value="Derecho Constitucional">Derecho Constitucional</option>
                <option value="Derecho Laboral">Derecho Laboral</option>
                <option value="Derecho Penal">Derecho Penal</option>
                <option value="Diseño Sostenible">Diseño Sostenible</option>
                <option value="Economía Aplicada">Economía Aplicada</option>
                <option value="Finanzas">Finanzas</option>
                <option value="Gerencia">Gerencia</option>
                <option value="Gestión de Calidad">Gestión de Calidad</option>
                <option value="Gestión Organizacional">Gestión Organizacional</option>
                <option value="Logística">Logística</option>
                <option value="Normas NIIF">Normas NIIF</option>
                <option value="Producción">Producción</option>
                <option value="Revisoría Fiscal">Revisoría Fiscal</option>
                <option value="Tributaria">Tributaria</option>
              </select>
              <div class="text-red-600 text-xs mt-1" *ngIf="hasError('programa')">
                {{ getErrorMessage('programa') }}
              </div>
            </div>
          </div>
      </div>

      <!-- <h3 class="text-lg font-semibold mb-4 pb-2 border-b text-gray-700">Asignar Docente</h3>

      <div class="flex flex-wrap mb-4">
        <div class="w-full lg:w-12/12 px-2">
              <div class="space-y-2">
                <label for="dirTematico" class="block text-sm font-medium text-gray-700">Buscar Director Temático *</label>
                <input
                  (focus)="docentesTabla = true"
                  (blur)="docentesTabla = false"
                  type="text" 
                  class="w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                  placeholder="Buscar colaborador"
                  [ngModelOptions]="{standalone: true}"
                  [(ngModel)]="searchTextDocentesTematicos"
                  (ngModelChange)="onSearchChangeDocentesTematicos()">
              </div>
              <div class="mt-1">
                @if (docentesSeleccionados.length > 0) {
                <div class="flex items-center">
                  <div class="text-sm text-gray-500 bg-gray-100 pl-2 pr-1 py-1 rounded-full flex items-center">David Carvajal - Docente
                    <button type="button" class="ml-2 hover:text-destructive-foreground">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x">
                        <path d="M18 6 6 18"></path>
                        <path d="m6 6 12 12"></path>
                      </svg>
                    </button>
                  </div>
                </div>
                }
              </div>
              @if (docentesTabla) {
                <div class="bg-card text-card-foreground flex flex-col gap-1 shadow-sm p-2 mt-1 max-h-40 overflow-y-auto" (mousedown)="$event.preventDefault()">
                  <div class="space-y-1">
                    @for (docente of docentes; track docente.id) {
                    <div class="flex items-center justify-between rounded-md hover:bg-gray-100 transition-colors cursor-pointer p-1">
                      <div class="flex items-center">
                        <div>
                          <p class="text-sm text-gray-500">{{ docente.nombreUsuario }} - {{docente.codigoEstudiante}}</p>
                        </div>
                      </div>
                      <button class="text-sm bg-blue-500 hover:bg-blue-600 text-white px-4 py-1 rounded-md transition-colors">Asignar</button>
                    </div>
                    }
                    @empty {
                      <div class="flex items-center justify-center">
                        <p class="text-xs text-gray-500">No se encontraron resultados</p>
                      </div>
                    }
                  </div>
                </div>
              }
              
          </div>
      </div> -->
      <!-- <div class="flex flex-wrap mb-4">
        <div class="w-full lg:w-12/12 px-2">
          <div class="space-y-2">
            <label for="dirMetodologico" class="block text-sm font-medium text-gray-700">Buscar Director Metodológico *</label>
            <input 
                name="dirMetodologico"
                type="text" 
                class="w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                placeholder="Buscar colaborador"
                [ngModelOptions]="{standalone: true}"
                [(ngModel)]="searchTextDocentesMetodologicos"
                (ngModelChange)="onSearchChangeDocentesMetodologicos()">
          </div>
        </div>
      </div> -->

        
      

    </div>
    <!--footer-->
    <div class="flex items-center justify-end p-5 border-t border-solid border-blueGray-200 rounded-b">
      <button class="text-red-500 background-transparent font-bold uppercase px-6 py-2 text-sm outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150" type="button" (click)="handleCancel()">
        Cancelar
      </button>
      @if (modo === 'crear') {
        <button class="bg-emerald-500 text-white active:bg-emerald-600 font-bold uppercase text-sm px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150" type="submit">
          Crear
        </button>
      }
      @if (modo === 'editar') {
        <button class="bg-emerald-500 text-white active:bg-emerald-600 font-bold uppercase text-sm px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150" type="submit">
          Actualizar
        </button>
      }
    </div>
    </form>
  </div>
</div>

@if (_alerta.showAlert) {
  <app-alerta-informativo
      [type]="_alerta.alertType"
      [message]="_alerta.alertMessage">
  </app-alerta-informativo>
  }